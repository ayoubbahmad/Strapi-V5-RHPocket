function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["index-BE_75e6q-DfG-Z9WC.js","strapi-Ddy60Q00.js","strapi-COJtagOC.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{P as g,h8 as q,h9 as k,ha as Ge,m as J,a as y,cq as _e,hb as He,a8 as O,o as v,hc as d,p as e,x as A,z as Ne,A as je,B as U,T as ee,M as We,hd as Ke,aX as Se,N as ke,he as Xe,hf as P,hg as Ze,hh as Ye,hi as Je,hj as es,hk as ss,hl as E,hm as ts,Y as $,ao as Le,hn as as,at as W,bK as os,co as Re,ap as ns,ho as is,fC as rs,af as ls,hp as ds,hq as cs,G as Z,hr as us,as as gs,hs,ht as fs,F as z,ak as ps,bG as ms,hu as xs,bj as K,hv as js,hw as bs,hx as ys,hy as vs,hz as Fs,c_ as Cs,Z as L,ae as Y,aU as be,aV as Ms,hA as Ss,hB as ye,hC as ks,hD as Ls,L as Rs,ad as As,aF as ws,hE as Es,am as ve,au as Ts,an as Ds,aw as b,fy as Bs,hF as Is,bk as Ps,W as $s,X as qs,a0 as Fe,hG as Os,K as Us,u as zs,O as Qs,U as Vs,hH as X,hI as Gs,E as _s}from"./strapi-Ddy60Q00.js";const Hs=(s,{pathname:a,query:o})=>{let n=[{id:null,label:{id:d("plugin.name"),defaultMessage:"Media Library"},href:s?E(a,o):void 0}];return s?.parent?.parent&&n.push([]),s?.parent&&n.push({id:s.parent.id,label:s.parent.name,href:E(a,o,{folder:s.parent.id,folderPath:s.parent.path})}),s&&n.push({id:s.id,label:s.name}),n},Ns=s=>{const{id:a}=vs();return e.jsx(U,{position:"relative",zIndex:2,children:e.jsx(Le,{"aria-labelledby":`${a}-title`,...s})})},Ae=({selected:s,onSuccess:a})=>{const{formatMessage:o}=v(),{remove:n}=Es(),i=async()=>{await n(s),a()};return e.jsxs(ve.Root,{children:[e.jsx(ve.Trigger,{children:e.jsx(L,{variant:"danger-light",size:"S",startIcon:e.jsx(Ts,{}),children:o({id:"global.delete",defaultMessage:"Delete"})})}),e.jsx(Ds,{onConfirm:i})]})};Ae.propTypes={selected:g.arrayOf(q,k).isRequired,onSuccess:g.func.isRequired};const Ws=()=>{const{formatMessage:s}=v(),{toggleNotification:a}=Us(),o=zs(),{post:n}=Qs(),r=Vs(({destinationFolderId:p,filesAndFolders:h})=>{const c=h.reduce((u,M)=>{const{id:l,type:S}=M,m=S==="asset"?"fileIds":"folderIds";return u[m]||(u[m]=[]),u[m].push(l),u},{});return n("/upload/actions/bulk-move",{...c,destinationFolderId:p})},{onSuccess(p){const{data:{data:h}}=p;h?.files?.length>0&&(o.refetchQueries([X,"assets"],{active:!0}),o.refetchQueries([X,"asset-count"],{active:!0})),o.refetchQueries([X,"folders"],{active:!0}),a({type:"success",message:s({id:d("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."})})}});return{...r,move:(p,h)=>r.mutateAsync({destinationFolderId:p,filesAndFolders:h})}},se=({onClose:s,selected:a,currentFolder:o})=>{const{formatMessage:n}=v(),{data:i,isLoading:r}=Is(),{move:f}=Ws();if(!i)return null;const p=async(c,{setErrors:u})=>{try{await f(c.destination.value,a),s()}catch(M){const S=Gs(M).errors.reduce((m,T)=>(m[T.values?.path?.length||"destination"]=T.defaultMessage,m),{});_s(S)||u(S)}};if(r)return e.jsx(b.Content,{children:e.jsx(b.Body,{children:e.jsx(z,{justifyContent:"center",paddingTop:4,paddingBottom:4,children:e.jsx(Ps,{children:n({id:d("content.isLoading"),defaultMessage:"Content is loading."})})})})});const h={destination:{value:o?.id||"",label:o?.name||i[0].label}};return e.jsx(b.Content,{children:e.jsx($s,{validateOnChange:!1,onSubmit:p,initialValues:h,children:({values:c,errors:u,setFieldValue:M})=>e.jsxs(qs,{noValidate:!0,children:[e.jsx(b.Header,{children:e.jsx(b.Title,{children:n({id:d("modal.folder.move.title"),defaultMessage:"Move elements to"})})}),e.jsx(b.Body,{children:e.jsx(Z.Root,{gap:4,children:e.jsx(Z.Item,{xs:12,col:12,direction:"column",alignItems:"stretch",children:e.jsxs(Fe.Root,{id:"folder-destination",children:[e.jsx(Fe.Label,{children:n({id:d("form.input.label.folder-location"),defaultMessage:"Location"})}),e.jsx(Os,{options:i,onChange:l=>{M("destination",l)},defaultValue:c.destination,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:u?.destination,ariaErrorMessage:"destination-error"}),u.destination&&e.jsx(ee,{variant:"pi",tag:"p",textColor:"danger600",children:u.destination})]})})})}),e.jsxs(b.Footer,{children:[e.jsx(b.Close,{children:e.jsx(L,{variant:"tertiary",name:"cancel",children:n({id:"cancel",defaultMessage:"Cancel"})})}),e.jsx(L,{type:"submit",loading:r,children:n({id:"modal.folder.move.submit",defaultMessage:"Move"})})]})]})})})};se.defaultProps={currentFolder:void 0,selected:[]};se.propTypes={onClose:g.func.isRequired,currentFolder:k,selected:g.arrayOf(k,q)};const te=({selected:s,onSuccess:a,currentFolder:o})=>{const{formatMessage:n}=v(),[i,r]=y.useState(!1),f=()=>{r(!1),a()};return e.jsxs(b.Root,{open:i,onOpenChange:r,children:[e.jsx(b.Trigger,{children:e.jsx(L,{variant:"secondary",size:"S",startIcon:e.jsx(Bs,{}),children:n({id:"global.move",defaultMessage:"Move"})})}),e.jsx(se,{currentFolder:o,onClose:f,selected:s})]})};te.defaultProps={currentFolder:void 0,selected:[]};te.propTypes={onSuccess:g.func.isRequired,currentFolder:k,selected:g.arrayOf(q,k)};const ae=({selected:s,onSuccess:a,currentFolder:o})=>{const{formatMessage:n}=v();return e.jsxs(z,{gap:2,paddingBottom:5,children:[e.jsx(ee,{variant:"epsilon",textColor:"neutral600",children:n({id:d("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:s.filter(({type:i})=>i==="folder").length,numberAssets:s.filter(({type:i})=>i==="asset").length})}),e.jsx(Ae,{selected:s,onSuccess:a}),e.jsx(te,{currentFolder:o,selected:s,onSuccess:a})]})};ae.defaultProps={currentFolder:void 0,selected:[]};ae.propTypes={onSuccess:g.func.isRequired,currentFolder:k,selected:g.arrayOf(q,k)};const Ks=({isFiltering:s,canCreate:a,canRead:o})=>s?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:o?a?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},we=({canCreate:s,isFiltering:a,canRead:o,onActionClick:n})=>{const{formatMessage:i}=v(),r=Ks({isFiltering:a,canCreate:s,canRead:o});return e.jsx(Fs,{icon:o?void 0:Cs,action:s&&!a&&e.jsx(L,{variant:"secondary",startIcon:e.jsx(Y,{}),onClick:n,children:i({id:d("header.actions.add-assets"),defaultMessage:"Add new assets"})}),content:i({...r,id:d(r.id)})})};we.propTypes={canCreate:g.bool.isRequired,canRead:g.bool.isRequired,isFiltering:g.bool.isRequired,onActionClick:g.func.isRequired};const Xs=()=>{const[s,a]=y.useState(!1),{formatMessage:o}=v(),{trackUsage:n}=ke(),[{query:i},r]=O(),f=i?.filters?.$and||[],p=c=>{r({filters:{$and:c},page:1})},h=c=>{n("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(c[c.length-1])[0]}),r({filters:{$and:c},page:1})};return e.jsxs(be.Root,{open:s,onOpenChange:a,children:[e.jsx(be.Trigger,{children:e.jsx(L,{variant:"tertiary",startIcon:e.jsx(Ms,{}),size:"S",children:o({id:"app.utils.filters",defaultMessage:"Filters"})})}),e.jsx(Ss,{displayedFilters:ye,filters:f,onSubmit:h,onToggle:a}),e.jsx(ks,{appliedFilters:f,filtersSchema:ye,onRemoveFilter:p})]})},oe=({breadcrumbs:s,canCreate:a,folder:o,onToggleEditFolderDialog:n,onToggleUploadAssetDialog:i})=>{const{formatMessage:r}=v(),{pathname:f}=Se(),[{query:p}]=O(),h={...p,folder:o?.parent?.id??void 0,folderPath:o?.parent?.path??void 0};return e.jsx($.Header,{title:r({id:d("plugin.name"),defaultMessage:"Media Library"}),subtitle:s&&o&&e.jsx(Ls,{tag:"nav",label:r({id:d("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:s,currentFolderId:o?.id}),navigationAction:o&&e.jsx(Rs,{tag:As,startIcon:e.jsx(ws,{}),to:`${f}?${Re.stringify(h,{encode:!1})}`,children:r({id:d("header.actions.folder-level-up"),defaultMessage:"Back"})}),primaryAction:a&&e.jsxs(z,{gap:2,children:[e.jsx(L,{startIcon:e.jsx(Y,{}),variant:"secondary",onClick:n,children:r({id:d("header.actions.add-folder"),defaultMessage:"Add new folder"})}),e.jsx(L,{startIcon:e.jsx(Y,{}),onClick:i,children:r({id:d("header.actions.add-assets"),defaultMessage:"Add new assets"})})]})})};oe.defaultProps={breadcrumbs:!1,folder:null};oe.propTypes={breadcrumbs:g.oneOfType([Ge,g.bool]),canCreate:g.bool.isRequired,folder:k,onToggleEditFolderDialog:g.func.isRequired,onToggleUploadAssetDialog:g.func.isRequired};const Zs=J(U)`
  height: 3.2rem;
  display: flex;
  align-items: center;
`,Ce=J(ee)`
  max-width: 100%;
`,Me=J(U)`
  svg {
    path {
      fill: ${({theme:s})=>s.colors.neutral500};
    }
  }
`,Ys=()=>{const s=We(),{canRead:a,canCreate:o,canUpdate:n,canCopyLink:i,canDownload:r,canConfigureView:f,isLoading:p}=Ke(),h=y.useRef(),{formatMessage:c}=v(),{pathname:u}=Se(),{trackUsage:M}=ke(),[{query:l},S]=O(),m=!!(l._q||l.filters),[T,Ee]=Xe(Ze.view,P.GRID),R=T===P.GRID,{data:F,isLoading:Te,errors:De}=Ye({skipWhen:!a,query:l}),{data:Be,isLoading:Ie,errors:Pe}=Je({enabled:a&&F?.pagination?.page===1&&!es(l),query:l}),{data:Q,isLoading:ne,error:$e}=ss(l?.folder,{enabled:a&&!!l?.folder});$e?.response?.status===404&&s(u);const D=Be?.map(t=>({...t,type:"folder",folderURL:E(u,l,t.id),isSelectable:n}))??[],x=D?.length||0,B=F?.results?.map(t=>({...t,type:"asset",isSelectable:n}))||[],j=B?.length??0,qe=F?.pagination?.total,Oe=ne||Ie||p||Te,[ie,Ue]=y.useState(!1),[re,le]=y.useState(!1),[V,G]=y.useState(void 0),[_,de]=y.useState(void 0),[C,{selectOne:I,selectAll:ce}]=ts(["type","id"],[]),ue=C?.length>0&&C?.length!==j+x,H=()=>Ue(t=>!t),ge=({created:t=!1}={})=>{t&&l?.page!=="1"&&S({...l,page:1}),le(w=>!w)},he=(t,w)=>{t&&M("didSelectAllMediaLibraryElements"),ce(w)},fe=t=>{M("didSortMediaLibraryElements",{location:"upload",sort:t}),S({sort:t})},pe=t=>{de(t),le(!0)},ze=t=>{de(null),ge(t),h.current&&h.current.focus()},me=t=>{t===j&&F.pagination.page===F.pagination.pageCount&&F.pagination.page>1&&S({...l,page:F.pagination.page-1})},Qe=()=>{ce(),me(C.length)};return Oe?e.jsx(A.Loading,{}):De||Pe?e.jsx(A.Error,{}):e.jsxs($.Root,{children:[e.jsxs(A.Main,{children:[e.jsx(oe,{breadcrumbs:!ne&&Hs(Q,{pathname:u,query:l}),canCreate:o,onToggleEditFolderDialog:ge,onToggleUploadAssetDialog:H,folder:Q}),e.jsx($.Action,{startActions:e.jsxs(e.Fragment,{children:[n&&R&&(j>0||x>0)&&e.jsx(Zs,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200",children:e.jsx(Le,{"aria-label":c({id:d("bulk.select.label"),defaultMessage:"Select all folders & assets"}),checked:ue?"indeterminate":(j>0||x>0)&&C.length===j+x,onCheckedChange:t=>he(t,[...B,...D])})}),a&&R&&e.jsx(as,{value:l?.sort,onChangeSort:fe}),a&&e.jsx(Xs,{})]}),endActions:e.jsxs(e.Fragment,{children:[f?e.jsx(Me,{paddingTop:1,paddingBottom:1,children:e.jsx(W,{tag:os,to:{pathname:`${u}/configuration`,search:Re.stringify(l,{encode:!1})},label:c({id:"app.links.configure-view",defaultMessage:"Configure the view"}),children:e.jsx(ns,{})})}):null,e.jsx(Me,{paddingTop:1,paddingBottom:1,children:e.jsx(W,{label:c(R?{id:d("view-switch.list"),defaultMessage:"List View"}:{id:d("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>Ee(R?P.LIST:P.GRID),children:R?e.jsx(is,{}):e.jsx(rs,{})})}),e.jsx(ls,{label:c({id:d("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}})]})}),e.jsxs($.Content,{children:[C.length>0&&e.jsx(ae,{currentFolder:Q,selected:C,onSuccess:Qe}),x===0&&j===0&&e.jsx(we,{canCreate:o,canRead:a,isFiltering:m,onActionClick:H}),a&&!R&&(j>0||x>0)&&e.jsx(ds,{assetCount:j,folderCount:x,indeterminate:ue,onChangeSort:fe,onChangeFolder:(t,w)=>s(E(u,l,{folder:t,folderPath:w})),onEditAsset:G,onEditFolder:pe,onSelectOne:I,onSelectAll:he,rows:[...D,...B],selected:C,shouldDisableBulkSelect:!n,sortQuery:l?.sort??""}),a&&R&&e.jsxs(e.Fragment,{children:[x>0&&e.jsx(cs,{title:(m&&j>0||!m)&&c({id:d("list.folders.title"),defaultMessage:"Folders ({count})"},{count:x})||"",children:D.map(t=>{const Ve=!!C.filter(({type:N})=>N==="folder").find(N=>N.id===t.id),xe=E(u,l,{folder:t?.id,folderPath:t?.path});return e.jsx(Z.Item,{col:3,direction:"column",alignItems:"stretch",children:e.jsx(us,{ref:_&&t.id===_.id?h:void 0,ariaLabel:t.name,id:`folder-${t.id}`,to:xe,startAction:I&&t.isSelectable?e.jsx(Ns,{"data-testid":`folder-checkbox-${t.id}`,checked:Ve,onCheckedChange:()=>I(t)}):null,cardActions:e.jsx(W,{"aria-label":c({id:d("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>pe(t),children:e.jsx(gs,{})}),children:e.jsx(hs,{children:e.jsx(fs,{to:xe,children:e.jsxs(z,{tag:"h2",direction:"column",alignItems:"start",maxWidth:"100%",children:[e.jsxs(Ce,{fontWeight:"semiBold",textColor:"neutral800",ellipsis:!0,children:[t.name,e.jsx(ps,{children:":"})]}),e.jsx(Ce,{tag:"span",textColor:"neutral600",variant:"pi",ellipsis:!0,children:c({id:d("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:t.children.count,filesCount:t.files.count})})]})})})})},`folder-${t.id}`)})}),j>0&&x>0&&e.jsx(U,{paddingTop:6,paddingBottom:4,children:e.jsx(ms,{})}),j>0&&e.jsx(xs,{assets:B,onEditAsset:G,onSelectAsset:I,selectedAssets:C.filter(({type:t})=>t==="asset"),title:(!m||m&&x>0)&&F?.pagination?.page===1&&c({id:d("list.assets.title"),defaultMessage:"Assets ({count})"},{count:qe})||""})]}),e.jsxs(K.Root,{...F.pagination,children:[e.jsx(K.PageSize,{}),e.jsx(K.Links,{})]})]})]}),ie&&e.jsx(js,{open:ie,onClose:H,trackedLocation:"upload",folderId:l?.folder}),re&&e.jsx(bs,{open:re,onClose:ze,folder:_,parentFolderId:l?.folder,location:"upload"}),V&&e.jsx(ys,{onClose:t=>{t===null&&me(1),G(void 0)},open:!!V,asset:V,canUpdate:n,canCopyLink:i,canDownload:r,trackedLocation:"upload"})]})},Js=y.lazy(()=>_e(()=>import("./index-BE_75e6q-DfG-Z9WC.js"),__vite__mapDeps([0,1,2]))),st=()=>{const{config:{isLoading:s,isError:a,data:o}}=He(),[{rawQuery:n},i]=O(),{formatMessage:r}=v(),f=r({id:d("plugin.name"),defaultMessage:"Media Library"});return y.useEffect(()=>{s||a||n||i({sort:o.sort,page:1,pageSize:o.pageSize})},[s,a,o,n,i]),s?e.jsxs(e.Fragment,{children:[e.jsx(A.Title,{children:f}),e.jsx(A.Loading,{})]}):e.jsx(A.Main,{children:n?e.jsx(y.Suspense,{fallback:e.jsx(A.Loading,{}),children:e.jsxs(Ne,{children:[e.jsx(je,{index:!0,element:e.jsx(Ys,{})}),e.jsx(je,{path:"configuration",element:e.jsx(Js,{config:o})})]})}):null})};export{st as default};
